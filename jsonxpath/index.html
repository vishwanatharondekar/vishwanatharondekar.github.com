<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>- jsFiddle demo</title>

<script type="text/javascript"
	src="http://code.jquery.com/jquery-1.8.3.js"></script>

<link rel="stylesheet" type="text/css" href="/css/normalize.css">


<link rel="stylesheet" type="text/css" href="/css/result-light.css">

<style type="text/css">
ul {
	margin-left: 1em;
}

ul {
	display: none;
	border: 1px solid black;
	padding: 1px;
}

.json-key {
	font-weight: bold;
	padding-left: 5px;
}

.json-key:hover {
	color: red;
	cursor: pointer;
}

.json-expand:hover {
	cursor: pointer;
}

.json-expand:hover::before {
	content: "+";
}

.json-expand::before {
	content: ">";
}
</style>



<script type="text/javascript">//<![CDATA[ 
$(window).load(function(){
    function visitObj($container, obj) {
        var $ul = $('<ul>');

        for (var prop in obj) {

            var $li = $('<li>');
            $li.append('<span class="json-key">' + prop + ' </span>');
            if (typeof obj[prop] === "object") {
                 $li.append('<span class="json-expand"></span>');
                 visitObj($li, obj[prop]);
            } else {
                $li.append('<span class="json-value">:'+obj[prop]+'</span>');                   
            }
            $ul.append($li);
        }
        $container.append($ul);
    }


    var jsonData = {
       "Attempted":"EditUser",
       "Exception":{
          "Message":"Something",
          "TargetSite":"somewhere",
          "Inner Exception":{
             "Message":"Something else",
             "TargetSite":"somewhere.core",
                 "Inner Exception":{
                "Message":"Another message",
                "TargetSite":"something.core.subr",
                "Inner Exception":{
                   "Message":"Object reference not set to an instance of an object.",
                   "TargetSite":"System.Web.Mvc.ActionResult Update(Int32, System.String, System.String)",
                   "StackTrace":[
                      "cvbvcb"
                   ],
                   "Inner Exception":{

                   }
                }
             }
          }
       },
       "details":{
          "userEmail":"test@email.com",
          "userId":"25",
          "userRole":"User"
       }
    };

    visitObj($('#json-viewer'), jsonData);

$('.json-key').click(function(){
    var allParents = $(this).parentsUntil($('#json-viewer')).filter('li');
    var xPathExpression = "";
    for(var i=allParents.size()-1;i>=0; i--){
        var element = allParents[i]
        var key = $(element).find(">span.json-key").text().trim();
        xPathExpression += key+"/";
    }
    xPathExpression = xPathExpression.substr(0, xPathExpression.length-1);
    console.log(xPathExpression);
});

$('.json-expand').click(function(){
    $(this).siblings('ul').toggle();
})

});//]]>  

</script>


</head>
<body>
	<div id="json-viewer">
		<span>JSON</span><span class="json-expand"></span>
	</div>
	<div id="xpath"></div>






</body>
</html>
